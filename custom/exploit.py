import util_marshal
import random
import time
import re
import string
# you can check available modules in conf.json


# fill the following function
def exploit(_opponent):
    alphanum = list(string.digits + string.ascii_lowercase + string.ascii_uppercase)
    flag_str = "".join([random.choice(alphanum) for _ in range(25)])
    flag = "CCIT{" + flag_str + "}"
    flag_regex = "CCIT[{][0-9a-zA-Z]{25}[}]"
    res = random.choice([flag, "lol nope"])
    flags_found = re.findall(flag_regex, res)
    time.sleep(2)
    return flags_found


if __name__ == "__main__":
    opponents = []
    service = "service-name_vulnerability-name"
    serial = util_marshal.serialize_exploit(exploit, opponents, service)
    # don't change the name of the file, otherwise you will not be able to get the serialized exploit
    with open("volume/uuid_exploit.JSON", 'w') as f:
        f.write(serial)
    flags = exploit("10.0.0.36")
    print(flags)
